# Create Azure Entra Group




# Generate random value for the login passwords
resource "random_password" "pentester_user_pwd" {
  length           = 12
  lower            = true
  min_lower        = 2
  min_numeric      = 2
  min_special      = 1
  min_upper        = 1
  numeric          = true
  override_special = "_"
  special          = true
  upper            = true
}

# Create Azure AD User
resource "azuread_user" "azentra_user_pentester" {
  user_principal_name = "pentester@${var.emaildomain}"
  display_name        = "Pentester (${var.project})"
  mail_nickname       = "pentester"
  password            = random_password.pentester_user_pwd.result
  fax_number          = "555-1337"
  job_title           = "L33t |-|4x0r"
  // usage_location      = "GB"

}

resource "azuread_group" "azentra_group_guacamole" {
    display_name = "Guacamole_Users"
    description = "Guacamole User Group"
    security_enabled = true
    mail_enabled = false
    members = [azuread_user.azentra_user_pentester.id]
}